# The effects of the Iberian exception

This repository contains files to replicate the figures and tables in *Haro-Ruiz, M., Schult, C. & Wunder, C. (2023). The effects of the Iberian Exception mechanism on wholesale electricity prices and consumer inflation. A synthetic-controls approach.*

To ensure the reproducibility of the results, this project is deployable through a Docker container. You must have [Docker](https://www.docker.com/) installed in you local machine to deploy it.

Begin by cloning this repository from the command line: 

```shell
git clone https://github.com/mharoruiz/iberian_exception
cd iberian_exception
```

The next step is to build the image specefied in the `Dockerfile`. The first time the image is build may take a few minutes, as all the necessary R packages will be downloaded and installed. The `Dockerfile` also instructs the image to execute `main.R`, which replicates the figures and tables in the paper.[^1] Build the image with the following command:

```shell
docker build . -t {IMAGE-NAME}:{TAG}
```

Once the image is built, you can access the output generated by `main.R`. To do so, first run a container with the generated image: 

```shell 
docker run -d --name {CONTAINER-NAME} {IMAGE-NAME}:{TAG}
```

Now, coppy the directories generated by `main.R` into your local directory as follows:

```shell 
docker cp {CONTAINER-NAME}:/home/rstudio/iberian_exception/03_results $(pwd)/03_results
docker cp {CONTAINER-NAME}:/home/rstudio/iberian_exception/04_output $(pwd)/04_output
```

You will be able to access two new directories; `03_results/` contains .csv files with the estimated synthetic series (generated by `01_functions/estimate_sc.R`), as well as inference for these estimates (generated by `01_functions/inference_sc.R`); `04_output/` includes the resulting .png plots and tables in .csv. 

[^1]: The runtime of `main.R` is regulared by variable `prc`, which is defined in line 23 and determines the precision of the confidence intervals for the treatment effect. By default, `prc=.1`, allowing for a quick execution. Once the docker image is built with the default value and the packages are cached, you may want to tweak `prc` for more precise –and longer computation of– confidence intervals. Note that the results in the paper were esimated with `prc=.001`. 